args:
- description: IPv4 address to filter.
  name: left
  required: true
- description: Comma-separated list of IPv4 ranges in CIDR notation against which
    to match.
  name: right
  required: true
comment: Checks whether an IPv4 address is not contained in one or more comma-delimited
  CIDR ranges.
commonfields:
  id: IsNotInCidrRanges
  version: -1
dockerimage: demisto/netutils:1.0.0.5165
enabled: true
name: IsNotInCidrRanges
runas: DBotWeakRole
runonce: false
script: |2



  from netaddr import IPAddress, IPNetwork


  def main():
      ip_address = demisto.args()['left']
      cidr_range_list = argToList(demisto.args()['right'])

      for cidr in cidr_range_list:
          if IPAddress(ip_address) in IPNetwork(cidr):
              demisto.results(False)
              return

      demisto.results(True)


  if __name__ == "__builtin__" or __name__ == "builtins":
      main()
scripttarget: 0
subtype: python3
system: true
tags:
- filter
type: python
